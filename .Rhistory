sourceDir <- "./script/"
rFile <- dir(sourceDir, ".R$")
for (ir in 1:length(rFile)){
source(paste0(sourceDir, rFile[ir]))
}
dataDir <- "./data/"
## De novo data
data <- read.table(paste0(dataDir, "FullDataSet_DenovoMutations_for_mTADA.txt"), header = TRUE, as.is = TRUE)
## Single-trait parameters
sPar <- read.table(paste0(dataDir, "SingleTrait_Parameters.txt"), as.is = TRUE, header = TRUE)
trait1 = "DD"
trait2 = "EE"
##Take a quick look at the single-trait parameters of DD and EE
sPar[grep(trait1, sPar[, 1]), ] ##Trait 1
sPar[grep(trait2, sPar[, 1]), ] ##Trait 2
### Trait-1 INFORMATION
ntrio1 = 4293 #family numbers
p1 = 0.02936283 #The proportion of risk genes, this is p1S
meanGamma1 = c(22.31762802,  86.03966530) #Mean Gamma of two categories
beta1 = c(0.82594514, 0.80689775) #Beta values inside the distribution RR ~ Gamma(meanRR*beta, beta)
dataT1 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait1)] #De novo data
muDataT1 <- data[, c("mut_damaging", "mut_lof")] #Mutation data of the first trait
### Trait-2 INFORMATION
ntrio2 = 356
p2 = 0.01548789 #This is p2S
meanGamma2 = c(51.08181282, 65.15189031)
beta2 = c(0.80906448, 0.80774192)
dataT2 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait2)]
muDataT2 <- muDataT1
nIteration = 2000 #This should be higher to obtain better results.
nChain = 2 #The number of MCMC chains
mTADAresults <- mTADA(geneName = data[, 1],
#######Trait-1 information
ntrio1 = ntrio1, # Trio number of Trait 1
p1 = p1, #Risk-gene proportion of Trait 1
dataDN1 = data.frame(dataT1), #De novo data of Trait 1
mutRate1 = data.frame(muDataT1), # Mutation rates of Trait 1
hyperGammaMeanDN1 = c(meanGamma1), # Mean relative risks of Trait 1
hyperBetaDN01 = beta1, #NULL, #array(c(1, 1)),                                        #######Trait-2 information
ntrio2 = ntrio2, # Trio number of Trait 2
p2 = p2, #Risk-gene proportion of Trait 2
dataDN2 = data.frame(dataT2), # De novo data of Trait 2
mutRate2 = data.frame(muDataT2), # Mutation rates of Trait 2
hyperGammaMeanDN2 = c(meanGamma2), # Mean relative risks of Trait 2
hyperBetaDN02 = beta2, #NULL, #array(c(1, 1)),                                        ####Other parameters
nIteration = nIteration,
useMCMC = TRUE, #If FALSE, it will use the 'Variational Bayes' approach.
nChain = nChain
)
fData <- mTADAresults$data ## Full analysis results of the two-trait analysis.
head(fData)
fData[fData$BOTH > 0.8, ]
fData[fData$FIRST > 0.8, ]
fData[fData$SECOND > 0.8, ]
fData[, 'pTrait1'] <- fData[, 'BOTH'] + fData[, 'FIRST']
fData1 <- fData[fData$pTrait1 > 0.8, ]
head(fData1[, c(1:5, 10)])
fData[, 'pTrait2'] <- fData[, 'BOTH'] + fData[, 'SECOND']
fData2 <- fData[fData$pTrait2 > 0.8, ]
head(fData2[, c(1:5, 11)])
pCI <- mTADAresults$pars ## Genetic parameters
piValue <- mTADAresults$probModel ## Posterior probabilities of genes for four models
mcmcResult <- mTADAresults$mcmcData ##MCMC results
piValue
pCI ## Mode: estimated values; CI: credible interval with low (l) and upper (u) values
## p12 is pi3 in the model
plotParHeatmap1(mcmcResult = mcmcResult, pars = c('p12', 'gammaMeanDN1[1]'))
sourceDir <- "./script/"
rFile <- dir(sourceDir, ".R$")
for (ir in 1:length(rFile)){
source(paste0(sourceDir, rFile[ir]))
}
dataDir <- "./data/"
sourceDir <- "./script/"
rFile <- dir(sourceDir, ".R$")
for (ir in 1:length(rFile)){
source(paste0(sourceDir, rFile[ir]))
}
dataDir <- "./data/"
## De novo data
data <- read.table(paste0(dataDir, "FullDataSet_DenovoMutations_for_mTADA.txt"), header = TRUE, as.is = TRUE)
## Single-trait parameters
sPar <- read.table(paste0(dataDir, "SingleTrait_Parameters.txt"), as.is = TRUE, header = TRUE)
trait1 = "DD"
trait2 = "EE"
##Take a quick look at the single-trait parameters of DD and EE
sPar[grep(trait1, sPar[, 1]), ] ##Trait 1
sPar[grep(trait2, sPar[, 1]), ] ##Trait 2
### Trait-1 INFORMATION
ntrio1 = 4293 #family numbers
p1 = 0.02936283 #The proportion of risk genes, this is p1S
meanGamma1 = c(22.31762802,  86.03966530) #Mean Gamma of two categories
beta1 = c(0.82594514, 0.80689775) #Beta values inside the distribution RR ~ Gamma(meanRR*beta, beta)
dataT1 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait1)] #De novo data
muDataT1 <- data[, c("mut_damaging", "mut_lof")] #Mutation data of the first trait
### Trait-2 INFORMATION
ntrio2 = 356
p2 = 0.01548789 #This is p2S
meanGamma2 = c(51.08181282, 65.15189031)
beta2 = c(0.80906448, 0.80774192)
dataT2 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait2)]
muDataT2 <- muDataT1
nIteration = 2000 #This should be higher to obtain better results.
nChain = 2 #The number of MCMC chains
mTADAresults <- mTADA(geneName = data[, 1],
#######Trait-1 information
ntrio1 = ntrio1, # Trio number of Trait 1
p1 = p1, #Risk-gene proportion of Trait 1
dataDN1 = data.frame(dataT1), #De novo data of Trait 1
mutRate1 = data.frame(muDataT1), # Mutation rates of Trait 1
hyperGammaMeanDN1 = c(meanGamma1), # Mean relative risks of Trait 1
hyperBetaDN01 = beta1, #NULL, #array(c(1, 1)),                                        #######Trait-2 information
ntrio2 = ntrio2, # Trio number of Trait 2
p2 = p2, #Risk-gene proportion of Trait 2
dataDN2 = data.frame(dataT2), # De novo data of Trait 2
mutRate2 = data.frame(muDataT2), # Mutation rates of Trait 2
hyperGammaMeanDN2 = c(meanGamma2), # Mean relative risks of Trait 2
hyperBetaDN02 = beta2, #NULL, #array(c(1, 1)),                                        ####Other parameters
nIteration = nIteration,
useMCMC = TRUE, #If FALSE, it will use the 'Variational Bayes' approach.
nChain = nChain
)
fData <- mTADAresults$data ## Full analysis results of the two-trait analysis.
head(fData)
fData[fData$BOTH > 0.8, ]
fData[fData$FIRST > 0.8, ]
fData[fData$SECOND > 0.8, ]
fData[, 'pTrait1'] <- fData[, 'BOTH'] + fData[, 'FIRST']
fData1 <- fData[fData$pTrait1 > 0.8, ]
head(fData1[, c(1:5, 10)])
fData[, 'pTrait2'] <- fData[, 'BOTH'] + fData[, 'SECOND']
fData2 <- fData[fData$pTrait2 > 0.8, ]
head(fData2[, c(1:5, 11)])
pCI <- mTADAresults$pars ## Genetic parameters
piValue <- mTADAresults$probModel ## Posterior probabilities of genes for four models
mcmcResult <- mTADAresults$mcmcData ##MCMC results
piValue
pCI ## Mode: estimated values; CI: credible interval with low (l) and upper (u) values
## p12 is pi3 in the model
plotParHeatmap1(mcmcResult = mcmcResult, pars = c('p12', 'gammaMeanDN1[1]'))
nIteration = 1000 #This should be higher to obtain better results.
nChain = 2 #The number of MCMC chains
mTADAresults <- mTADA(geneName = data[, 1],
#######Trait-1 information
ntrio1 = ntrio1, # Trio number of Trait 1
p1 = p1, #Risk-gene proportion of Trait 1
dataDN1 = data.frame(dataT1), #De novo data of Trait 1
mutRate1 = data.frame(muDataT1), # Mutation rates of Trait 1
hyperGammaMeanDN1 = c(meanGamma1), # Mean relative risks of Trait 1
hyperBetaDN01 = beta1, #NULL, #array(c(1, 1)),                                        #######Trait-2 information
ntrio2 = ntrio2, # Trio number of Trait 2
p2 = p2, #Risk-gene proportion of Trait 2
dataDN2 = data.frame(dataT2), # De novo data of Trait 2
mutRate2 = data.frame(muDataT2), # Mutation rates of Trait 2
hyperGammaMeanDN2 = c(meanGamma2), # Mean relative risks of Trait 2
hyperBetaDN02 = beta2, #NULL, #array(c(1, 1)),                                        ####Other parameters
nIteration = nIteration,
useMCMC = TRUE, #If FALSE, it will use the 'Variational Bayes' approach.
nChain = nChain
)
sourceDir <- "./script/"
rFile <- dir(sourceDir, ".R$")
for (ir in 1:length(rFile)){
source(paste0(sourceDir, rFile[ir]))
}
dataDir <- "./data/"
sourceDir <- "./script/"
rFile <- dir(sourceDir, ".R$")
for (ir in 1:length(rFile)){
source(paste0(sourceDir, rFile[ir]))
}
dataDir <- "./data/"
## De novo data
data <- read.table(paste0(dataDir, "FullDataSet_DenovoMutations_for_mTADA.txt"), header = TRUE, as.is = TRUE)
## Single-trait parameters
sPar <- read.table(paste0(dataDir, "SingleTrait_Parameters.txt"), as.is = TRUE, header = TRUE)
trait1 = "DD"
trait2 = "EE"
##Take a quick look at the single-trait parameters of DD and EE
sPar[grep(trait1, sPar[, 1]), ] ##Trait 1
sPar[grep(trait2, sPar[, 1]), ] ##Trait 2
### Trait-1 INFORMATION
ntrio1 = 4293 #family numbers
p1 = 0.02936283 #The proportion of risk genes, this is p1S
meanGamma1 = c(22.31762802,  86.03966530) #Mean Gamma of two categories
beta1 = c(0.82594514, 0.80689775) #Beta values inside the distribution RR ~ Gamma(meanRR*beta, beta)
dataT1 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait1)] #De novo data
muDataT1 <- data[, c("mut_damaging", "mut_lof")] #Mutation data of the first trait
### Trait-2 INFORMATION
ntrio2 = 356
p2 = 0.01548789 #This is p2S
meanGamma2 = c(51.08181282, 65.15189031)
beta2 = c(0.80906448, 0.80774192)
dataT2 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait2)]
muDataT2 <- muDataT1
nIteration = 1000 #This should be higher to obtain better results.
nChain = 2 #The number of MCMC chains
mTADAresults <- mTADA(geneName = data[, 1],
#######Trait-1 information
ntrio1 = ntrio1, # Trio number of Trait 1
p1 = p1, #Risk-gene proportion of Trait 1
dataDN1 = data.frame(dataT1), #De novo data of Trait 1
mutRate1 = data.frame(muDataT1), # Mutation rates of Trait 1
hyperGammaMeanDN1 = c(meanGamma1), # Mean relative risks of Trait 1
hyperBetaDN01 = beta1, #NULL, #array(c(1, 1)),                                        #######Trait-2 information
ntrio2 = ntrio2, # Trio number of Trait 2
p2 = p2, #Risk-gene proportion of Trait 2
dataDN2 = data.frame(dataT2), # De novo data of Trait 2
mutRate2 = data.frame(muDataT2), # Mutation rates of Trait 2
hyperGammaMeanDN2 = c(meanGamma2), # Mean relative risks of Trait 2
hyperBetaDN02 = beta2, #NULL, #array(c(1, 1)),                                        ####Other parameters
nIteration = nIteration,
useMCMC = TRUE, #If FALSE, it will use the 'Variational Bayes' approach.
nChain = nChain
)
fData <- mTADAresults$data ## Full analysis results of the two-trait analysis.
head(fData)
fData[fData$BOTH > 0.8, ]
fData[fData$FIRST > 0.8, ]
fData[fData$SECOND > 0.8, ]
fData[, 'pTrait1'] <- fData[, 'BOTH'] + fData[, 'FIRST']
fData1 <- fData[fData$pTrait1 > 0.8, ]
head(fData1[, c(1:5, 10)])
fData[, 'pTrait2'] <- fData[, 'BOTH'] + fData[, 'SECOND']
fData2 <- fData[fData$pTrait2 > 0.8, ]
head(fData2[, c(1:5, 11)])
pCI <- mTADAresults$pars ## Genetic parameters
piValue <- mTADAresults$probModel ## Posterior probabilities of genes for four models
mcmcResult <- mTADAresults$mcmcData ##MCMC results
piValue
pCI ## Mode: estimated values; CI: credible interval with low (l) and upper (u) values
## p12 is pi3 in the model
plotParHeatmap1(mcmcResult = mcmcResult, pars = c('p12', 'gammaMeanDN1[1]'))
sourceDir <- "./script/"
rFile <- dir(sourceDir, ".R$")
for (ir in 1:length(rFile)){
source(paste0(sourceDir, rFile[ir]))
}
dataDir <- "./data/"
## De novo data
data <- read.table(paste0(dataDir, "FullDataSet_DenovoMutations_for_mTADA.txt"), header = TRUE, as.is = TRUE)
## Single-trait parameters
sPar <- read.table(paste0(dataDir, "SingleTrait_Parameters.txt"), as.is = TRUE, header = TRUE)
trait1 = "DD"
trait2 = "EE"
##Take a quick look at the single-trait parameters of DD and EE
sPar[grep(trait1, sPar[, 1]), ] ##Trait 1
sPar[grep(trait2, sPar[, 1]), ] ##Trait 2
### Trait-1 INFORMATION
ntrio1 = 4293 #family numbers
p1 = 0.02936283 #The proportion of risk genes, this is p1S
meanGamma1 = c(22.31762802,  86.03966530) #Mean Gamma of two categories
beta1 = c(0.82594514, 0.80689775) #Beta values inside the distribution RR ~ Gamma(meanRR*beta, beta)
dataT1 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait1)] #De novo data
muDataT1 <- data[, c("mut_damaging", "mut_lof")] #Mutation data of the first trait
### Trait-2 INFORMATION
ntrio2 = 356
p2 = 0.01548789 #This is p2S
meanGamma2 = c(51.08181282, 65.15189031)
beta2 = c(0.80906448, 0.80774192)
dataT2 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait2)]
muDataT2 <- muDataT1
nIteration = 2000 #This should be higher to obtain better results.
nChain = 2 #The number of MCMC chains
##########MAIN ANALYSIS
mTADAresults <- mTADA(geneName = data[, 1],
#######Trait-1 information
ntrio1 = ntrio1, # Trio number of Trait 1
p1 = p1, #Risk-gene proportion of Trait 1
dataDN1 = data.frame(dataT1), #De novo data of Trait 1
mutRate1 = data.frame(muDataT1), # Mutation rates of Trait 1
hyperGammaMeanDN1 = c(meanGamma1), # Mean relative risks of Trait 1
hyperBetaDN01 = beta1, #NULL, #array(c(1, 1)),
#######Trait-2 information
ntrio2 = ntrio2, # Trio number of Trait 2
p2 = p2, #Risk-gene proportion of Trait 2
dataDN2 = data.frame(dataT2), # De novo data of Trait 2
mutRate2 = data.frame(muDataT2), # Mutation rates of Trait 2
hyperGammaMeanDN2 = c(meanGamma2), # Mean relative risks of Trait 2
hyperBetaDN02 = beta2, #NULL, #array(c(1, 1)),
####Other parameters
nIteration = nIteration,
useMCMC = TRUE, #If FALSE, it will use the 'Variational Bayes' approach.
nChain = nChain
)
fData <- mTADAresults$data ## Full analysis results of the two-trait analysis.
head(fData)
fData[fData$BOTH > 0.8, ]
fData[fData$FIRST > 0.8, ]
fData[fData$SECOND > 0.8, ]
fData[, 'pTrait1'] <- fData[, 'BOTH'] + fData[, 'FIRST']
fData1 <- fData[fData$pTrait1 > 0.8, ]
head(fData1[, c(1:5, 10)])
fData[, 'pTrait2'] <- fData[, 'BOTH'] + fData[, 'SECOND']
fData2 <- fData[fData$pTrait2 > 0.8, ]
head(fData2[, c(1:5, 11)])
pCI <- mTADAresults$pars ## Genetic parameters
piValue <- mTADAresults$probModel ## Posterior probabilities of genes for four models
mcmcResult <- mTADAresults$mcmcData ##MCMC results
piValue
pCI ## Mode: estimated values; CI: credible interval with low (l) and upper (u) values
## p12 is pi3 in the model
plotParHeatmap1(mcmcResult = mcmcResult, pars = c('p12', 'gammaMeanDN1[1]'))
getwd()
source(script/mTADA.R)
source("script/mTADA.R")
dataDir <- "./data/"
source("script/mTADA.R")
## De novo data
data <- read.table(paste0(dataDir, "FullDataSet_DenovoMutations_for_mTADA.txt"), header = TRUE, as.is = TRUE)
## Single-trait parameters
sPar <- read.table(paste0(dataDir, "SingleTrait_Parameters.txt"), as.is = TRUE, header = TRUE)
trait1 = "DD"
trait2 = "EE"
##Take a quick look at the single-trait parameters of DD and EE
sPar[grep(trait1, sPar[, 1]), ] ##Trait 1
sPar[grep(trait2, sPar[, 1]), ] ##Trait 2
### Trait-1 INFORMATION
ntrio1 = 4293 #family numbers
p1 = 0.02936283 #The proportion of risk genes, this is p1S
meanGamma1 = c(22.31762802,  86.03966530) #Mean Gamma of two categories
beta1 = c(0.82594514, 0.80689775) #Beta values inside the distribution RR ~ Gamma(meanRR*beta, beta)
dataT1 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait1)] #De novo data
muDataT1 <- data[, c("mut_damaging", "mut_lof")] #Mutation data of the first trait
##########################################
### Trait-2 INFORMATION
ntrio2 = 356
p2 = 0.01548789 #This is p2S
meanGamma2 = c(51.08181282, 65.15189031)
beta2 = c(0.80906448, 0.80774192)
dataT2 <- data[, paste0(c("dn_damaging_", "dn_lof_"), trait2)]
muDataT2 <- muDataT1
nIteration = 2000 #This should be higher to obtain better results.
nChain = 2 #The number of MCMC chains
##########MAIN ANALYSIS
mTADAresults <- mTADA(geneName = data[, 1],
#######Trait-1 information
ntrio1 = ntrio1, # Trio number of Trait 1
p1 = p1, #Risk-gene proportion of Trait 1
dataDN1 = data.frame(dataT1), #De novo data of Trait 1
mutRate1 = data.frame(muDataT1), # Mutation rates of Trait 1
hyperGammaMeanDN1 = c(meanGamma1), # Mean relative risks of Trait 1
hyperBetaDN01 = beta1, #NULL, #array(c(1, 1)),
#######Trait-2 information
ntrio2 = ntrio2, # Trio number of Trait 2
p2 = p2, #Risk-gene proportion of Trait 2
dataDN2 = data.frame(dataT2), # De novo data of Trait 2
mutRate2 = data.frame(muDataT2), # Mutation rates of Trait 2
hyperGammaMeanDN2 = c(meanGamma2), # Mean relative risks of Trait 2
hyperBetaDN02 = beta2, #NULL, #array(c(1, 1)),
####Other parameters
nIteration = nIteration,
useMCMC = TRUE, #If FALSE, it will use the 'Variational Bayes' approach.
nChain = nChain
)
fData <- mTADAresults$data ## Full analysis results of the two-trait analysis.
head(fData)
fData[fData$BOTH > 0.8, ]
fData[fData$FIRST > 0.8, ]
fData[fData$SECOND > 0.8, ]
fData[, 'pTrait1'] <- fData[, 'BOTH'] + fData[, 'FIRST']
fData1 <- fData[fData$pTrait1 > 0.8, ]
head(fData1[, c(1:5, 10)])
fData[, 'pTrait2'] <- fData[, 'BOTH'] + fData[, 'SECOND']
fData2 <- fData[fData$pTrait2 > 0.8, ]
head(fData2[, c(1:5, 11)])
pCI <- mTADAresults$pars ## Genetic parameters
piValue <- mTADAresults$probModel ## Posterior probabilities of genes for four models
mcmcResult <- mTADAresults$mcmcData ##MCMC results
piValue
pCI ## Mode: estimated values; CI: credible interval with low (l) and upper (u) values
## p12 is pi3 in the model
plotParHeatmap1(mcmcResult = mcmcResult, pars = c('p12', 'gammaMeanDN1[1]'))
knit_with_parameters('~/Documents/GitHub/mTADA/README_mTADA_DD_EE.Rmd')
